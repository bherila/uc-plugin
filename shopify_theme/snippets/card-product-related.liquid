{% comment %}
  Renders a related product card

  Accepts:
  - card_product: {Object} Product Liquid object (optional)
  - media_aspect_ratio: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
  - image_shape: {String} Image mask to apply to the product image card. Values are "arch", "blob", "chevronleft", "chevronright", "diamond", "parallelogram", and "round". (optional)
  - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
  - show_vendor: {Boolean} Show the product vendor. Default: false
  - show_rating: {Boolean} Show the product rating. Default: false
  - extend_height: {Boolean} Card height extends to available container space. Default: true (optional)
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)
  - skip_styles: {Boolean} Don't include component styles. Useful when rendering multiple product cards in a loop. Default: false (optional)
  - quick_add: {Boolean} Show the quick add button.
  - section_id: {String} The ID of the section that contains this card.
  - horizontal_class: {Boolean} Add a card--horizontal class if set to true. Default: false (optional)
  - horizontal_quick_add: {Boolean} Changes the quick add button styles when set to true. Default: false (optional)
  - placeholder_image: {String} The placeholder image to use when no product exists. Default: 'product-apparel-2' (optional)

  Usage:
  {% render 'card-product-related', show_vendor: section.settings.show_vendor %}
{% endcomment %}
{%- if card_product and card_product != empty -%}
  {%- liquid
    assign ratio = 1
    if card_product.featured_media and media_aspect_ratio == 'portrait'
      assign ratio = 0.8
    elsif card_product.featured_media and media_aspect_ratio == 'adapt'
      assign ratio = card_product.featured_media.aspect_ratio
    endif
    if ratio == 0 or ratio == null
      assign ratio = 1
    endif
  -%}
  <div class="underline-links-hover">
    {%- if card_product.featured_media -%}
      <a
        href="{{ card_product.url }}"
        class="full-unstyled-link"
        aria-labelledby="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }} NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
      >
        <div class="related-top">
          <div class="related-countdown">
            <div class="ends-in">ENDS IN</div>
            <div class="timer">{%- render 'countdown-timer-related.js', card_product: card_product -%}</div>
          </div>
          <div class="related-card-media">
            <img
              src="{{ card_product.featured_media | image_url }}"
              alt="{{ card_product.featured_media.alt | escape }}"
              class="motion-reduce"
              {% unless lazy_load == false %}
                loading="lazy"
              {% endunless %}
              width="100%"
              height="100%"
            >
          </div>
        </div>
      </a>
    {%- endif -%}
    <div class="related-card-information related-bottom">
      <h3
        class="related-card-heading"
        {% if card_product.featured_media == null and settings.card_style == 'standard' %}
          id="title-{{ section_id }}-{{ card_product.id }}"
        {% endif %}
      >
        <a
          href="{{ card_product.url }}"
          id="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }}"
          class="full-unstyled-link"
          aria-labelledby="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }} NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
        >
          {{ card_product.title | escape }}
        </a>
      </h3>
      <div class="price-item-wrapper">
        {% render 'price', product: card_product, price_class: '', show_compare_at_price: true %} PER BOTTLE
      </div>
      <a
        href="{{ card_product.url }}"
        id="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }}"
        class="full-unstyled-link"
        aria-labelledby="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }} NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
      >
        <div class="view-details"><span>VIEW DETAILS</span></div>
      </a>
    </div>
  </div>
{%- endif -%}
